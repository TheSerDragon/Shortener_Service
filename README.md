# Shortener Service (Console)

Консольное приложение для сокращения ссылок с поддержкой TTL, лимита переходов и многопользовательского режима.

---

## Установка

1. Клонировать репозиторий:

```bash
git clone <your-repo-url>
cd <repo-folder>
```

2. Сборка через Maven:

```bash
mvn clean compile
```

3. Настройка конфигурации (необязательно):

Файл `config/app.properties`:

```properties
link.ttl.default=86400          # TTL ссылки в секундах (по умолчанию 24 часа)
link.maxClicks.default=10       # Максимальное количество переходов по ссылке
cleanup.interval=60             # Интервал очистки устаревших ссылок в секундах
```

Если файла нет, используются значения по умолчанию.

---

## Запуск

```bash
mvn exec:java -Dexec.mainClass="shortener.Main"
```

При первом запуске создаётся UUID пользователя (сохраняется в файле `.shortener-uuid`).

---

## Команды CLI

| Команда                                    | Описание                |                                                               |
|--------------------------------------------| ----------------------- | ------------------------------------------------------------- |
| `create <longUrl> [maxClicks]`             | Создать короткую ссылку (по умолчанию `maxClicks=10`) |                                                               |
| `list`                                     | Вывести список ссылок пользователя |                                                               |
| `open <code>  `                            | Открыть ссылку (попытка открыть браузер, если поддерживается)                        |  |
| `delete <code>`                            | Удалить ссылку (только владелец) |                                                               |
| `stats <code>`                             | Показать статистику ссылки |                                                               |
| `update <code> [ttl=seconds] [max=clicks]` | Изменить TTL и/или лимит переходов (только владелец) |                                                               |
| `help`                                     | Показать справку        |                                                               |
| `exit`                                     | Выйти из приложения     |                                                               |

Примеры:

```text
> create https://example.com 20
> list
> update abc123 ttl=7200 max=50
> open abc123
> delete abc123
```

---

## Архитектура

* **Link** – модель ссылки (с TTL, лимитом кликов, счётчиком переходов).
* **LinkStore** – хранилище ссылок (ConcurrentHashMap) с поддержкой поиска по владельцу.
* **ShortenerService** – бизнес-логика: генерация кодов, открытие ссылок, редактирование TTL и лимита.
* **NotificationService** – уведомления пользователя (консоль).
* **Cleaner** – периодическая очистка истёкших ссылок.
* **UserService** – управление UUID пользователей.
* **ConsoleScanner** – CLI-интерфейс для работы с приложением.
* **Main** – точка входа: инициализация сервисов, запуск CLI и периодической очистки.

---

## Тестирование

* Unit-тесты для:

    * `ConfigTest` – проверка конфигурации.
    * `LinkStoreTest` – добавление/получение ссылок.
    * `ShortenerServiceTest` – генерация коротких ссылок.
* Запуск тестов:

```bash
mvn test
```

Покрытие основных модулей >50%.

---

## Особенности

* Мультипользовательский режим: каждый пользователь идентифицируется UUID.
* Безопасное редактирование: изменение TTL и лимита доступно только владельцу ссылки.
* Автоудаление ссылок по истечении TTL.
* Уведомления при исчерпании лимита или истечении срока действия.
